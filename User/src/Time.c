/*-------------------------------------------------------------------
/*      (C) Copyright 2023, PSYM. All Rights Reserved
/*-------------------------------------------------------------------
/* File name   : Time.c
/* Description :
/* Author      : PSYM
/*-------------------------------------------------------------------
/* Update note:
/* -----------   -----------   --------------------------------------
/*    Date         Author                       Note
/* -----------   -----------   --------------------------------------
/* 2023-05-25,     psym
/*   14:08
**/

/* 包含头文件 -------------------------------------------------------*/
#include "Time.h"

/* 私有类型定义 -----------------------------------------------------*/
/* None. */

/* 私有宏定义 -------------------------------------------------------*/
/* None. */

/* 私有变量 ---------------------------------------------------------*/
uint8 count;

/* 扩展变量 ---------------------------------------------------------*/

/* 私有函数原形 -----------------------------------------------------*/
/* None. */

/* 函数体 -----------------------------------------------------------*/

/**
 * @brief: 定时器0初始化
 * @param: None
 * @return: None
 * @note: None
 */
void Time0_Config()
{
    // @24MHZ 1ms 12T时钟模式
    TMOD &= 0xF0; // 清零T0的控制位
    TMOD |= 0x01; // 设置T0为模式1
    // 设置为1ms
    TH0 = (65536 - 2000) / 256;
    TL0 = (65536 - 2000) % 256;
    TF0 = 0; // 清除TF0标志
    ET0 = 1;
    TR0 = 1; // 定时器0开始计时
}

void Time0_ISR() interrupt 1
{
    TF0 = 0;
    TR0 = 0;

    if (++count % 200 == 0)
    {
        LCD1602_ShowString(10, 0, "1602LCD");
        LCD1602_ShowString(15, 1, "HELLO WORLD");
        LCD_roll(roll);
    }
    
	KeyScan();

    TH0 = (65536 - 2000) / 256;
    TL0 = (65536 - 2000) % 256;
    TR0 = 1;
}

/*>>>>>>>>>> (C) COPYRIGHT PSYM <<<<<< >>>>>> END OF FILE <<<<<<<<<<*/
